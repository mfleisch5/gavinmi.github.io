<link rel="stylesheet" type = "text/css" href="style.css">
<!DOCTYPE HTML>

<html>
	<head>
		<title>DA+ Homepage</title>

		<!-- ONLY PUT PAGE-SPECIFIC STYLE IN HERE -->
		<style>
			div#prog_bar {
				margin: 0 auto 50px;
				height: 75px;
				background: linear-gradient(#333, #222);
				border-radius: 4px;
				overflow: hidden;
			}
			div#prog_bar div#bar {
				background: linear-gradient(#1D992B, darkgreen);
				width: 0px; height: 100%;
				transition: 0.5s ease;
				display: inline-block;
			}
			div#prog_bar div#percent {
				color: white;
				text-align: center;
				font-size: 21px;
				text-shadow: 0px 0px 5px rgba(0, 0, 0, 1);
				padding-top: 24px;

				width: calc(100% - 330px);
				position: absolute;
			}
			div#prog_bar label {
				text-align: center;
				position: absolute;
				width: 93px;
				user-select: none;
				display: inline;
				top: 90px; margin-left: -46.5px;
			}
			div#prog_bar label div:first-child {
			  width: 0;
			  height: 0;
			  border-left: 5px solid transparent;
			  border-right: 5px solid transparent;
			  border-bottom: 5px solid #333;
				margin: 0 auto;
			}
			div#prog_bar label div:not(:first-child) {
				background-color: #333;
				border-radius: 5px;
				color: white;
				padding: 5px;
				text-align: center;
			}
			div#prog_bar label.left { margin-left: -15px; text-align: left; }
			div#prog_bar label.left div:first-child { margin: 0; margin-left: 10px; }
			div#prog_bar label.right { margin-left: -60px; text-align: right; }
			div#prog_bar label.right div:first-child { margin: 0; margin-left: 55px; }

			ul li > div:not(:first-child) {
				border-top: 1px solid #777;
				margin: 10 10 0 10; padding: 10 0 10 0;
				display: none;
			}
			ul li.visible > div:not(:first-child) {display: block;}
			ul li > div:not(:first-child) h4 { margin: 0; padding: 0; }
			ul li > div:not(:first-child) p { margin: 0 0 10px 20px; }
			ul li > div:not(:first-child) button {
				padding: 4px 10px;
				background-color: #F5F5F5;
			}

			ul li { padding: 0; }
			ul li > div:first-child { cursor: pointer; }

			/*#main_body { white-space: nowrap; }*/
		</style>

	</head>
	<body>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<script src="data.js" type="text/javascript"></script>

		<menu id="nav_bar">
			<img src="" onclick="location.href='homepage.html'">
			<a class="current" href="homepage.html">Dashboard</a>
			<a href="classes.html">Add/Browse Courses</a>
			<a href="schedule.html">Semester Plan</a>
			<a href="old_index.html" disabled>Settings</a>
		</menu>

		<section id="main_body">

			<div id="prog_bar">
				<div id="percent">Progress - 0%</div>
				<div id="bar" style="width: 0%;"></div>
				<label id="label"><div></div><div>Freshman</div></label>
			</div>

			<!----------------------------------------------------------------------->
			<!--   This SECTION elements contains the info cards on the homepage   -->
			<!--   They have already been populated with mock info as an example   -->
			<!----------------------------------------------------------------------->
			<section id="info_cards">
				<card>
					<details open>
						<summary id="current_label"><span>Current Semester (0)</span></summary>
						<ul id="current_semester"></ul>
					</details>
					<details open>
						<summary id="upcoming_label"><span>Upcoming Semester (0)</span></summary>
						<ul id="upcoming_semester"></ul>
					</details>
				</card>

				<card>
					<details class="completed_class">
						<summary id="completed_label"><span>Completed (0)</span></summary>
						<ul id="completed" class="closed"></ul>
					</details>
					<details open>
						<summary id="reqs_label"><span>Major Requirements (0)</span></summary>
						<ul id="requirements"></ul>
					</details>
				</card>
			</section>

		</section>
		<script>
			student = load();
			var completed = 0, current = 0, upcoming = 0, total = 0;

			for (var i = 1; i < student.semester; i++) {
				for (var j = 0; j < student.classes[i].length; j++) {
					var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span'),
							desc_title = document.createElement('h4'), desc = document.createElement('p'),
							prereq_title = document.createElement('h4'), prereq = document.createElement('div'),
							coreq_title = document.createElement('h4'), coreq = document.createElement('div'),
							add = document.createElement('button'), body = document.createElement('div');
					title.title = student.classes[i][j].name; title.innerHTML = title.title;
					credits.innerHTML = "(" + student.classes[i][j].credits + ")"; completed+=student.classes[i][j].credits;
					$(desc_title).html("Course Description"); $(desc).html(student.classes[i][j].description);
					$(prereq_title).html("Prerequisites"); $(coreq_title).html("Co-requisites");
					for(var k = 0; k < student.classes[i][j].prerequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.classes[i][j].prerequisites[k]);
						$(prereq).append(temp);
					}
					if(student.classes[i][j].prerequisites.length == 0) { $(prereq).html("<p>None</p>"); }
					for(var k = 0; k < student.classes[i][j].corequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.classes[i][j].corequisites[k]);
						$(coreq).append(temp);
					}
					if(student.classes[i][j].corequisites.length == 0) { $(coreq).html("<p>None</p>"); }
					$(add).html("Add");

					$("#completed").append($(course).append([title, credits, $(body).append([desc_title, desc, prereq_title, prereq, coreq_title, coreq])]));
				}
			}
			$("#completed_label").html("<span>Completed (" + completed + ")</span>");
			for (var j = 0; j < student.classes[student.semester].length; j++) {
				var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span'),
						desc_title = document.createElement('h4'), desc = document.createElement('p'),
						prereq_title = document.createElement('h4'), prereq = document.createElement('div'),
						coreq_title = document.createElement('h4'), coreq = document.createElement('div'),
						add = document.createElement('button'), body = document.createElement('div');
				title.title = student.classes[student.semester][j].name; title.innerHTML = title.title;
				credits.innerHTML = "(" + student.classes[student.semester][j].credits + ")"; current+=student.classes[student.semester][j].credits;
				$(desc_title).html("Course Description"); $(desc).html(student.classes[student.semester][j].description);
				$(prereq_title).html("Prerequisites"); $(coreq_title).html("Co-requisites");
				for(var k = 0; k < student.classes[student.semester][j].prerequisites.length; k++) {
					var temp = document.createElement("p");
					$(temp).html(student.classes[student.semester][j].prerequisites[k]);
					$(prereq).append(temp);
				}
				if(student.classes[student.semester][j].prerequisites.length == 0) { $(prereq).html("<p>None</p>"); }
				for(var k = 0; k < student.classes[student.semester][j].corequisites.length; k++) {
					var temp = document.createElement("p");
					$(temp).html(student.classes[student.semester][j].corequisites[k]);
					$(coreq).append(temp);
				}
				if(student.classes[student.semester][j].corequisites.length == 0) { $(coreq).html("<p>None</p>"); }
				$(add).html("Add");

				$("#current_semester").append($(course).append([title, credits, $(body).append([desc_title, desc, prereq_title, prereq, coreq_title, coreq])]));
			}
			$("#current_label").html("<span>Current Semester (" + current + ")</span>");
			if(getUpcomingSem() != null) {
				for (var j = 0; j < student.classes[getUpcomingSem()].length; j++) {
					var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span'),
							desc_title = document.createElement('h4'), desc = document.createElement('p'),
							prereq_title = document.createElement('h4'), prereq = document.createElement('div'),
							coreq_title = document.createElement('h4'), coreq = document.createElement('div'),
							add = document.createElement('button'), body = document.createElement('div');
					title.title = student.classes[getUpcomingSem()][j].name; title.innerHTML = title.title;
					credits.innerHTML = "(" + student.classes[getUpcomingSem()][j].credits + ")"; upcoming+=student.classes[getUpcomingSem()][j].credits;
					$(desc_title).html("Course Description"); $(desc).html(student.classes[getUpcomingSem()][j].description);
					$(prereq_title).html("Prerequisites"); $(coreq_title).html("Co-requisites");
					for(var k = 0; k < student.classes[getUpcomingSem()][j].prerequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.classes[getUpcomingSem()][j].prerequisites[k]);
						$(prereq).append(temp);
					}
					if(student.classes[getUpcomingSem()][j].prerequisites.length == 0) { $(prereq).html("<p>None</p>"); }
					for(var k = 0; k < student.classes[getUpcomingSem()][j].corequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.classes[getUpcomingSem()][j].corequisites[k]);
						$(coreq).append(temp);
					}
					if(student.classes[getUpcomingSem()][j].corequisites.length == 0) { $(coreq).html("<p>None</p>"); }
					$(add).html("Add");

					$("#upcoming_semester").append($(course).append([title, credits, $(body).append([desc_title, desc, prereq_title, prereq, coreq_title, coreq])]));
				}
				$("#upcoming_label").html("<span>Upcoming Semester (" + upcoming + ")</span>");
			}
			for (var i = 0; i < 6; i++) {
				for (var j = 0; j < student.reqs[i].courses.length; j++) {
					var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span'),
							desc_title = document.createElement('h4'), desc = document.createElement('p'),
							prereq_title = document.createElement('h4'), prereq = document.createElement('div'),
							coreq_title = document.createElement('h4'), coreq = document.createElement('div'),
							add = document.createElement('button'), body = document.createElement('div');
					title.title = student.reqs[i].courses[j].name; title.innerHTML = title.title;
					credits.innerHTML = "(" + student.reqs[i].courses[j].credits + ")"; total+=student.reqs[i].courses[j].credits;
					$(desc_title).html("Course Description"); $(desc).html(student.reqs[i].courses[j].description);
					$(prereq_title).html("Prerequisites"); $(coreq_title).html("Co-requisites");
					for(var k = 0; k < student.reqs[i].courses[j].prerequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.reqs[i].courses[j].prerequisites[k]);
						$(prereq).append(temp);
					}
					if(student.reqs[i].courses[j].prerequisites.length == 0) { $(prereq).html("<p>None</p>"); }
					for(var k = 0; k < student.reqs[i].courses[j].corequisites.length; k++) {
						var temp = document.createElement("p");
						$(temp).html(student.reqs[i].courses[j].corequisites[k]);
						$(coreq).append(temp);
					}
					if(student.reqs[i].courses[j].corequisites.length == 0) { $(coreq).html("<p>None</p>"); }
					$(add).html("Add");

					$("#requirements").append($(course).append([title, credits, $(body).append([desc_title, desc, prereq_title, prereq, coreq_title, coreq])]));
				}
			}
			$("#reqs_label").html("<span>Major Requirements (" + total + ")</span>");

			$("ul li > div:first-child").click(function() { showdesc($(this).parent()); });
			function showdesc(element) { $(element).toggleClass("visible"); }

			updatePercent(completed/113);

			// p is number between 0 and 1
			function updatePercent(p) {
				$("#percent").html("Progress - " + Number(Math.round(p*100+'e2')+'e-2') + "%");
				$("#bar").css("width", p*100 + "%");

				var standings = ["Freshman", "Sophomore", "Junior", "Senior", "Senior"];
				$('#label').find(">:nth-child(2)").html(standings[Math.floor(p*100/25)]);

				if(p < 3/113) { $('#label').removeClass("right"); $('#label').addClass("left"); }
				else if(p > 110/113) { $('#label').removeClass("left"); $('#label').addClass("right"); }
				else { $('#label').removeClass("right"); $('#label').removeClass("left"); }
			}
		</script>

	</body>
<html>
