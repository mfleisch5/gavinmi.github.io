<link rel="stylesheet" type = "text/css" href="style.css">
<!DOCTYPE HTML>

<html>
	<head>
		<title>DA+ Homepage</title>

		<!-- ONLY PUT PAGE-SPECIFIC STYLE IN HERE -->
		<style>
			div#prog_bar {
				margin: 0 auto 50px;
				height: 75px;
				background: linear-gradient(#333, #222);
				border-radius: 4px;
				overflow: hidden;
			}
			div#prog_bar div#bar {
				background: linear-gradient(#1D992B, darkgreen);
				width: 0px; height: 100%;
				transition: 0.5s ease;
				display: inline-block;
			}
			div#prog_bar div#percent {
				color: white;
				text-align: center;
				font-size: 21px;
				text-shadow: 0px 0px 5px rgba(0, 0, 0, 1);
				padding-top: 24px;

				width: calc(100% - 330px);
				position: absolute;
			}
			div#prog_bar label {
				text-align: center;
				position: absolute;
				width: 75px;
				user-select: none;
				display: inline;
				top: 90px; margin-left: -37.5px;
			}
			div#prog_bar label div:first-child {
			  width: 0;
			  height: 0;
			  border-left: 5px solid transparent;
			  border-right: 5px solid transparent;
			  border-bottom: 5px solid #333;
				margin: 0 auto;
			}
			div#prog_bar label div:not(:first-child) {
				background-color: #333;
				border-radius: 5px;
				color: white;
				padding: 5px;
				text-align: center;
			}
			div#prog_bar label.left { margin-left: -15px; text-align: left; }
			div#prog_bar label.left div:first-child { margin: 0; margin-left: 10px; }
			div#prog_bar label.right { margin-left: -60px; text-align: right; }
			div#prog_bar label.right div:first-child { margin: 0; margin-left: 55px; }

			card {
				display: inline-block;
				vertical-align: top;
				min-height: 180px;
				max-height: calc(100% - 160px);
				width: calc(50% - 34px);
				margin-bottom: 10px;
			}

			#main_body { white-space: nowrap; }
			card summary, card ul { margin-bottom: 5px; }
			card summary { user-select: none; cursor: pointer; }
			card ul { margin-right: 30px; }
			card ul li:not(:last-child) { margin-bottom: 5px; }
		</style>

	</head>
	<body>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<script src="data.js" type="text/javascript"></script>

		<menu id="nav_bar">
			<img src="" onclick="location.href='homepage.html'">
			<a class="current" href="homepage.html">Home</a>
			<a href="classes.html">Class Search</a>
			<a href="schedule.html">Semester Plan</a>
			<a href="old_index.html" disabled>Settings</a>
		</menu>

		<section id="main_body">

			<div id="prog_bar">
				<div id="percent">Progress - 0%</div>
				<div id="bar" style="width: 0%;"></div>
				<label id="label"><div></div><div>Freshman</div></label>
			</div>

			<!----------------------------------------------------------------------->
			<!--   This SECTION elements contains the info cards on the homepage   -->
			<!--   They have already been populated with mock info as an example   -->
			<!----------------------------------------------------------------------->
			<section id="info_cards">
				<card>
					<details open>
						<summary id="current_label">Current Semester (0)</summary>
						<ul id="current_semester"></ul>
					</details>
					<details open>
						<summary id="upcoming_label">Upcoming Semester (0)</summary>
						<ul id="upcoming_semester"></ul>
					</details>
				</card>

				<card>
					<details class="completed_class">
						<summary id="completed_label">Completed (0)</summary>
						<ul id="completed" class="closed"></ul>
					</details>
					<details class="inprogress_class">
						<summary id="inprogress_label">In Progress (0)</summary>
						<ul id="in_progress" class="closed"></ul>
					</details>
					<details class="incomplete_class">
						<summary id="incomplete_label">Incomplete (0)</summary>
						<ul id="incomplete" class="closed"></ul>
					</details>
					<details open>
						<summary id="reqs_label">Major Requirements (0)</summary>
						<ul id="requirements"></ul>
					</details>
				</card>
			</section>

		</section>
		<script>
		function draw() {
			student = load();
			var completed = 0, current = 0, upcoming = 0, total = 0;

			for (var j = 0; j < student.classes[1].length; j++) {
				var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span');
				title.title = student.classes[1][j].name; title.innerHTML = title.title;
				credits.innerHTML = "(" + student.classes[1][j].credits + ")";
				$("#completed").append($(course).append([title, credits]));
				completed += student.classes[1][j].credits;
			}
			$("#completed_label").html("Completed (" + completed + ")");
			for (var j = 0; j < student.classes[2].length; j++) {
				var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span');
				title.title = student.classes[2][j].name; title.innerHTML = title.title;
				credits.innerHTML = "(" + student.classes[2][j].credits + ")";
				$("#current_semester").append($(course).append([title, credits]));
				$("#in_progress").append($(course).append([title, credits]).clone());
				current += student.classes[2][j].credits;
			}
			$("#current_label").html("Current Semester (" + current + ")");
			$("#inprogress_label").html("In Progress (" + current + ")");
			for (var j = 0; j < student.classes[5].length; j++) {
				var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span');
				title.title = student.classes[5][j].name; title.innerHTML = title.title;
				credits.innerHTML = "(" + student.classes[5][j].credits + ")";
				$("#upcoming_semester").append($(course).append([title, credits]));
				upcoming += student.classes[5][j].credits;
			}
			$("#upcoming_label").html("Upcoming Semester (" + upcoming + ")");
			for (var j = 0; j < student.reqs.length; j++) {
				var course = document.createElement('li'), title = document.createElement('div'), credits = document.createElement('span');
				title.title = student.reqs[j].name; title.innerHTML = title.title;
				credits.innerHTML = "(" + student.reqs[j].credits + ")";
				$("#requirements").append($(course).append([title, credits]));
				total += student.reqs[j].credits;
			}
			$("#reqs_label").html("Major Requirements (" + total + ")");

			updatePercent(completed/113);
		}
		draw();

		// p is number between 0 and 1
		function updatePercent(p) {
			document.getElementById("percent").innerHTML = "Progress - " + Number(Math.round(p*100+'e2')+'e-2') + "%";
			document.getElementById("bar").style.width = p*100 + "%";

			var standings = ["Freshman", "Sophomore", "Junior", "Senior", "Senior"];
			document.getElementById('label').children[1].innerHTML = standings[Math.floor(p*100/25)];

			if(p < 3/113) {
				document.getElementById('label').classList.remove("right");
				document.getElementById('label').classList.add("left");
			}
			else if(p > 110/113) {
				document.getElementById('label').classList.remove("left");
				document.getElementById('label').classList.add("right");
			}
			else {
				document.getElementById('label').classList.remove("right");
				document.getElementById('label').classList.remove("left");
			}
		}
		</script>

	</body>
<html>
